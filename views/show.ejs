<% layout("/layouts/boiler_plate") %>

<div class="row mt-4">
    <div class="col-8 offset-2">
        <h3 class="mb-4">Listing Details</h3>
        
        <div class="card show-card mx-auto" style="max-width: 500px;">
            <img src="<%= listing.image || '/images/default.jpg' %>" 
                 class="card-img-top show-img" 
                 alt="<%= listing.title %>" 
                 style="height: 250px; object-fit: cover;">
            
            <div class="card-body">
                <h5 class="card-title">
                    <i class="fa-solid fa-map-marker-alt me-2"></i>
                    <%= listing.title %>
                </h5>
                
                <ul class="list-unstyled">
                    <li class="mb-2"><strong>Description:</strong> <%= listing.description || 'No description' %></li>
                    <li class="mb-2"><strong>Price:</strong> &#8377;<%= (listing.price || 0).toLocaleString("en-IN") %></li>
                    <li class="mb-2"><strong>Location:</strong> <%= listing.location || listing.place || 'Not specified' %></li>
                    <li class="mb-2"><strong>Country:</strong> <%= listing.country || 'Not specified' %></li>
                </ul>

                <div class="btn-group d-flex gap-2 mt-4" role="group">
                    <!-- ✅ CORRECT VIEW LINK (plural listings) -->
                    <a href="/listings/<%= listing._id %>" class="btn btn-primary">
                        <i class="fa-solid fa-eye me-1"></i>View
                    </a>
                    
                    <!-- ✅ CORRECT EDIT LINK (plural listings) -->
                    <a href="/listings/<%= listing._id %>/edit" class="btn btn-warning">
                        <i class="fa-solid fa-pen-to-square me-1"></i>Edit
                    </a>
                    
                    <!-- ✅ CORRECT DELETE FORM -->
                    <form method="POST" action="/listings/<%= listing._id %>?_method=DELETE" 
                          style="display: inline;" 
                          onsubmit="return confirm('Are you sure you want to delete this listing?')">
                        <button type="submit" class="btn btn-danger">
                            <i class="fa-solid fa-trash me-1"></i>Delete
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
